在开展本文工作时，我们通过修改Chromium最新稳定版本Chromium 38的源代码，在Android上实现了这三种技术。 我们使用Content模块（ContentShell.apk构建目标），该模块具有构建Android谷歌Chrome浏览器的核心代码[5]。 与Content Shell相比，Chrome具有其他功能，例如自动填充，翻译和帐户设置同步。

总共，我们在Chromium网络浏览器的各个模块中添加了大约1,200行代码。 不需要对网站和操作系统内核进行生根或修改。 由于我们专注于页面加载时间，因此我们仅在加载网页期间启用这些技术，我们在加载完网页后禁用这些技术。

### 网络感知资源处理

我们通过修改浏览器进程中资源处理程序链中的BufferedResourceHandler类来实现自适应资源缓冲。 我们修改资源处理程序，使其保持缓存状态，直到收到的数据大小达到缓冲区阈值或Web资源提取已完成。 另外，修订后的处理程序决定嵌入在HTTP请求中的资源类型。 对于顶级HTML资源和嵌套框架，它不执行资源缓冲，以避免延迟加载HTML页面中嵌入的Web资源。

当渲染引擎尚未完成资源处理并且资源缓冲区中没有剩余空间时，缓冲资源处理程序可以暂停。 当它恢复时，它会继续接收数据。

### 适应性内容绘画

我们通过控制VSync回调的速率来控制内容绘制速度。为此，我们在WindowAndroid类上编写了一个填充图层，它代表一个Android活动窗口并拥有一个VSync监视器。该垫片层从VSync监视器截取实际的VSync回调，并在发送到合成器线程之前将其延迟多个VSync周期。

内容更改速度是通过查看来自Compositor线程的VSync请求来确定的。如果渲染引擎需要更新图层树，并且因此合成器线程仍需要一个VSync才能在绘制完所有更改后执行绘画，则表明内容自上次更改以来已更改。另一方面，当Compositor线程停止需要VSyncs执行另一个绘制时，这表明内容不会进一步改变。此时，我们停止向Android请求VSync并将帧速率限制降至最小值。

限制内容绘画速度可能会导致明显滞后
用户触摸屏幕。为了解决这个问题，我们检测用户输入来动态地启用和禁用内容绘制速率。我们通过检测表示网页视图的ContentViewCore类来完成此操作。因此，在页面加载期间，当用户与屏幕交互时，用户不会感觉到任何动画滞后

### 应用程序辅助调度

我们通过扩展当前Chromium线程管理模块来实现AAS，以动态和系统地支持更改线程CPU关联。在Android OS上，通过系统调用sched_setaffinity来更改线程CPU关联，这不需要root特权。由于Android 4.4上的默认仿生C库级别19不提供本地sched_setaffinity API，因此我们通过使用系统调用函数以及系统调用号和CPU内核列表直接调用其汇编语言接口。我们使用Chromium中的图层树调试功能监视帧速率，该功能提供帧速率计数器和绘图时间。

根据第2节中对Web浏览器体系结构的分析，AAS计划合成器栅格工作器和异步传输线程。这些线程会影响图形管道绘制到屏幕的帧的速率，因此与用户体验直接相关。它们的CPU占用率也很高，因此将它们安排到较小的核心将大大降低浏览器的能耗。